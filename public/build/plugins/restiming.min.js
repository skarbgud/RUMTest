!function(){BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.ResourceTiming){var h={other:0,img:1,link:2,script:3,css:4,xmlhttprequest:5,html:6,image:7,beacon:8,fetch:9,iframe:"a",subdocument:"a",body:"b",input:"c",frame:"a",object:"d",video:"e",audio:"f",source:"g",track:"h",embed:"i",eventsource:"j",navigation:6},b={prefetch:1,preload:2,prerender:3,stylesheet:4},M=["startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","workerStart"],f="\n",S="*",v="0",O="1",T="2",A=1,w=2,k=4,y="3",B="4",E="5",R="6",_={complete:!1,sentNavBeacon:!1,initialized:!1,supported:null,xhr_load:function(){if(!this.complete){this.complete=!0;BOOMR.sendBeacon()}},xssBreakWords:[/(h)(ref)/gi,/(s)(rc)/gi,/(a)(ction)/gi],urlLimit:500,clearOnBeacon:!1,trimUrls:[],serverTiming:!0,monitorClearResourceTimings:!1,splitAtPath:!1,getSrcsetDimensions:!1,trackedResourceTypes:"*",done:function(){if(!this.sentNavBeacon){e();this.complete=!0;this.sentNavBeacon=!0;BOOMR.sendBeacon()}},onBeacon:function(e){var t=BOOMR.getPerformance();if(_.clearOnBeacon&&t){var r=t.clearResourceTimings||t.webkitClearResourceTimings;r&&"function"==typeof r&&r.call(t)}},prerenderToVisible:function(){this.sentNavBeacon=!1;this.done()}};BOOMR.plugins.ResourceTiming={init:function(e){BOOMR.utils.pluginConfig(_,e,"ResourceTiming",["xssBreakWords","clearOnBeacon","urlLimit","trimUrls","trackedResourceTypes","serverTiming","monitorClearResourceTimings","splitAtPath","getSrcsetDimensions"]);if(_.initialized)return this;if(this.is_supported()){BOOMR.subscribe("page_ready",_.done,null,_);BOOMR.subscribe("prerender_to_visible",_.prerenderToVisible,null,_);BOOMR.subscribe("xhr_load",_.xhr_load,null,_);BOOMR.subscribe("beacon",_.onBeacon,null,_);BOOMR.subscribe("before_unload",_.done,null,_);if(_.monitorClearResourceTimings){var t=this;BOOMR.window.performance.clearResourceTimings=(r=BOOMR.window.performance.clearResourceTimings,function(){t.addResources(BOOMR.window.performance.getEntriesByType("resource"));r.apply(BOOMR.window.performance,arguments)})}}else _.complete=!0;var r;_.initialized=!0;return this},is_complete:function(){return!0},is_enabled:function(){return _.initialized&&this.is_supported()},is_supported:function(){if(null!==_.supported)return _.supported;var e=BOOMR.getPerformance();_.supported=e&&"function"==typeof e.getEntriesByType&&void 0!==window.PerformanceResourceTiming;return _.supported},addResources:function(e,t){if(this.is_supported()&&BOOMR.utils.isArray(e)){_.collectedEntries=_.collectedEntries||[];if("number"==typeof t){var n=t-(BOOMR.window.performance.timeOrigin||BOOMR.window.performance.timing.navigationStart);e=BOOMR.utils.arrayFilter(e,function(e){for(var t=0;t<M.length;t++){var r=M[t];e.hasOwnProperty(r)&&(e[r]+=n)}return!0})}Array.prototype.push.apply(_.collectedEntries,e)}},getCompressedResourceTiming:n,getFilteredResourceTiming:Y,calculateResourceTimingUnion:function(e){if(!e||!e.length)return 0;e.sort(function(e,t){return e.fetchStart!==t.fetchStart?e.fetchStart-t.fetchStart:(e.responseStart||e.responseEnd)-(t.responseStart||t.responseEnd)});for(var t=c(e),r=[],n=0,i=0;i<t.length;i++){var o=t[i];o.fetchStart<n&&(o.fetchStart=n);if(o.fetchStart<o.responseEnd){r.push(o);n=o.responseEnd}}var a=c(r),s=0;for(i=0;i<a.length;i++)s+=a[i].responseEnd-a[i].fetchStart;return s},addResourceTimingToBeacon:e,addToBeacon:i,trimTiming:C,roundUpTiming:z,convertToTrie:P,optimizeTrie:L,findPerformanceEntriesForFrame:I,toBase36:U,getVisibleEntries:W,reduceFetchStarts:c,compressSize:j,decompressSize:function(e,t){var r,n;void 0===t&&(t={});r=e.split(",");for(n=0;n<r.length;n++)if("_"===r[n])r[n]=0;else{""===r[n]&&(r[n]=0);r[n]=parseInt(r[n],36);0<n&&(r[n]+=r[0])}1===r.length&&r.push(r[0]);2===r.length&&r.push(r[0]);t.encodedBodySize=r[0];t.transferSize=r[1];t.decodedBodySize=r[2];return t},trimUrl:F,getResourceLatestTime:q,mergePixels:m,countPixels:l,getOptimizedTimepoints:function(e){for(var t,r,n,i,o,a,s,c,u={},d=[],f=Object.keys(e),p=0;p<f.length;p++){void 0===u[n=Math.round(Number(f[p]))]&&(u[n]=[]);Array.prototype.push.apply(u[n],e[f[p]])}if(0===(f=Object.keys(u).map(Number).sort(function(e,t){return e-t})).length)return{};for(p=0;p<f.length;p++){o=l(t=m(t,u[n=f[p]],n));f[p]=[n,o]}for(p=a=i=r=0;p<f.length;p++){n=f[p][0];o=f[p][1];s=l(t,0,n);if(i<o||a<s){c=(c=(n===1/0?"":U(Math.round(n-r)))+"~"+U(o-i)+"~"+U(o-s)).replace(/~~/,"-").replace(/~$/,"");d.push(c);r=n;i=o;a=s}}return d.join("!").replace(/!+$/,"")},decompressTimePoints:function(e){for(var t,r={},n=[0,0,0],i=e.split("!"),o=0;o<i.length;o++)r[(t=i[o].replace(/^~/,"Infinity~").replace("-","~0~").split("~").map(function(e,t){e="Infinity"===e?1/0:parseInt(e,36);2===t?e=n[1]-e:e+=n[t];return n[t]=e}))[0]]=[t[1],t[2]||t[1]];return r},accumulateServerTimingEntries:d,compressServerTiming:p,indexServerTiming:g,identifyServerTimingEntry:$,decompressServerTiming:function(e,t){var r=t.split(":"),n=Number(r[0]),i=0,o=0;if(1<r.length){var a=r[1].split(".");""!==a[0]&&(i=Number(a[0]));1<a.length&&(o=Number(a[1]))}var s,c="";if(Array.isArray(e[i])){s=e[i][0];c=e[i][1+o]||""}else s=e[i];return{name:s,duration:n,description:c}},SPECIAL_DATA_PREFIX:S,SPECIAL_DATA_DIMENSION_TYPE:v,SPECIAL_DATA_SIZE_TYPE:O,SPECIAL_DATA_SCRIPT_ATTR_TYPE:T,SPECIAL_DATA_LINK_ATTR_TYPE:B,SPECIAL_DATA_SERVICE_WORKER_TYPE:R,ASYNC_ATTR:A,DEFER_ATTR:w,LOCAT_ATTR:k,INITIATOR_TYPES:h,REL_TYPES:b}}function P(e,t){var r,n,i,o,a,s,c,u,d={};for(r in e){n=r;for(i=0;i<_.xssBreakWords.length;i++)n=n.replace(_.xssBreakWords[i],"$1"+f+"$2");if(e.hasOwnProperty(r)){o=e[r];a=t?[(a=n.split("/"))[0]+"//",a[2]+(3<a.length?"/":"")].concat(a.slice(3).reduce(function(o){return function(e,t,r){var n,i;if(-1!==t.indexOf(f)){n=t.split(f);for(i=0;i<n.length-1;i++){e.push(n[i]);e.push(f)}t=n.slice(-1)}"number"==typeof o&&r<o&&(t+="/");return e.concat(t)}}(a.length-4),[])):n.split("");c=d;for(i=0;i<a.length;i++)void 0===(u=c[s=a[i]])?c=c[s]=i===a.length-1?o:{}:"string"==typeof u?c=c[s]={"|":u}:i===a.length-1?c[s]["|"]=o:c=c[s]}}return d}function L(e,t){var r,n,i,o=0,a=[];for(r in e)e.hasOwnProperty(r)&&a.push(r);for(var s=0;s<a.length;s++){if("object"==typeof e[r=a[s]]&&(n=L(e[r],!1))){delete e[r];if(r===f){r=n.name;o++}else r+=n.name;e[r]=n.value}o++}if(1!==o)return!!t&&e;if(t){(i={})[r]=e[r];return i}return{name:r,value:e[r]}}function z(e){"number"!=typeof e&&(e=0);return Math.ceil(e||0)}function C(e,t){"number"!=typeof e&&(e=0);"number"!=typeof t&&(t=0);var r=Math.round(e||0),n=Math.round(t||0);return 0===r?0:r-n}function N(e){try{e.location&&e.location.href;e.document;if("performance"in e&&e.performance)return 1}catch(e){}}function x(e){var t=0;N(e)&&e.performance.timing&&e.performance.timing.navigationStart&&(t=e.performance.timing.navigationStart);return t}function I(e,t,r,n,i){var o,a,s,c,u,d,f,p,m,l,g,h=[],S={},v={};void 0===t&&(t=!0);void 0===r&&(r=0);void 0===n&&(n=0);if(10<n)return h;try{if(!N(e))return h;s=x(e);l=W(e,i);D(g=e.document.createElement("a"),S,"script");D(g,v,"link");if((d=e.document.getElementsByTagName("iframe"))&&d.length)for(o=0;o<d.length;o++){c=x(d[o].contentWindow);u=0;s<c&&(u=r+(c-s));g.href=d[o].src;h=h.concat(I(d[o].contentWindow,!1,u,n+1,l[g.href]))}if("function"!=typeof e.performance.getEntriesByType)return h;function O(e){return _.serverTiming&&e.serverTiming||[]}if(t)if((a=e.performance.getEntriesByType("navigation"))&&1===a.length){f=a[0];h.push({name:e.location.href,startTime:0,initiatorType:"html",redirectStart:f.redirectStart,redirectEnd:f.redirectEnd,fetchStart:f.fetchStart,domainLookupStart:f.domainLookupStart,domainLookupEnd:f.domainLookupEnd,connectStart:f.connectStart,secureConnectionStart:f.secureConnectionStart,connectEnd:f.connectEnd,requestStart:f.requestStart,responseStart:f.responseStart,responseEnd:f.responseEnd,workerStart:f.workerStart,encodedBodySize:f.encodedBodySize,decodedBodySize:f.decodedBodySize,transferSize:f.transferSize,serverTiming:O(f)})}else e.performance.timing&&0!==(p=e.performance.timing).navigationStart&&p.responseEnd<=p.navigationStart+36e5&&h.push({name:e.location.href,startTime:0,initiatorType:"html",redirectStart:p.redirectStart?p.redirectStart-p.navigationStart:0,redirectEnd:p.redirectEnd?p.redirectEnd-p.navigationStart:0,fetchStart:p.fetchStart?p.fetchStart-p.navigationStart:0,domainLookupStart:p.domainLookupStart?p.domainLookupStart-p.navigationStart:0,domainLookupEnd:p.domainLookupEnd?p.domainLookupEnd-p.navigationStart:0,connectStart:p.connectStart?p.connectStart-p.navigationStart:0,secureConnectionStart:p.secureConnectionStart?p.secureConnectionStart-p.navigationStart:0,connectEnd:p.connectEnd?p.connectEnd-p.navigationStart:0,requestStart:p.requestStart?p.requestStart-p.navigationStart:0,responseStart:p.responseStart?p.responseStart-p.navigationStart:0,responseEnd:p.responseEnd?p.responseEnd-p.navigationStart:0});var T=e.performance.getEntriesByType("resource"),y=[];if(e===BOOMR.window&&_.collectedEntries){Array.prototype.push.apply(T,_.collectedEntries);_.collectedEntries=[]}for(o=0;T&&o<T.length;o++){p=T[o];m={name:p.name,initiatorType:p.initiatorType,encodedBodySize:p.encodedBodySize,decodedBodySize:p.decodedBodySize,transferSize:p.transferSize,serverTiming:O(p),visibleDimensions:l[p.name],latestTime:q(p)};for(var B=0;B<M.length;B++){var E=M[B];m[E]="startTime"===E||p[E]?p[E]+r:0}p.hasOwnProperty("_data")&&(m._data=p._data);if(("script"===p.initiatorType||"link"===p.initiatorType)&&S[p.name]){var R=S[p.name];m.scriptAttrs=(R.async?A:0)|(R.defer?w:0);for(;1===R.nodeType&&"BODY"!==R.nodeName;)R=R.parentNode;m.scriptAttrs|="BODY"===R.nodeName?k:0}"link"===p.initiatorType&&v[p.name]&&BOOMR.utils.arrayFind(v[p.name].rel.split(/[\u0009\u000A\u000C\u000D\u0020]+/),function(e){e=e.toLowerCase();if(b[e]){m.linkAttrs=b[e];return!0}});y.push(m)}h=h.concat(y)}catch(e){return h}return h}function D(t,r,e){Array.prototype.forEach.call(t.ownerDocument.getElementsByTagName(e),function(e){t.href=e.currentSrc||e.src||"function"==typeof e.getAttribute&&e.getAttribute("xlink:href")||e.href;t.href.match(/^https?:\/\//)&&(r[t.href]=e)})}function U(e){return"number"==typeof e&&0!==e?e.toString(36):"string"==typeof e?e:""}function W(e,t){var u={},d=e.document,f=d.createElement("A"),p=(t=t||[0,0,0,0])[3]+(void 0!==e.pageXOffset)?e.pageXOffset:(d.documentElement||d.body.parentNode||d.body).scrollLeft,m=t[2]+(void 0!==e.pageYOffset)?e.pageYOffset:(d.documentElement||d.body.parentNode||d.body).scrollTop;["img","iframe","image"].forEach(function(e){for(var t,r,n,i,o,a,s=d.getElementsByTagName(e),c=0;c<s.length;c++)if(t=s[c]){n=t.currentSrc||t.src||"function"==typeof t.getAttribute&&t.getAttribute("src")||t.getAttribute("xlink:href");f.href=n;if((n=f.href)&&!u[n]&&((r=t.getBoundingClientRect()).height||t.offsetHeight)&&(r.width||t.offsetWidth)){u[n]=[r.height||t.offsetHeight,r.width||t.offsetWidth,Math.round(r.top+m),Math.round(r.left+p)];if(!t.naturalHeight&&!t.naturalWidth)continue;_.getSrcsetDimensions&&t.currentSrc&&(t.srcset||t.parentNode&&t.parentNode.nodeName&&"PICTURE"===t.parentNode.nodeName.toUpperCase())?(i=t.isConnected?t.ownerDocument.createElement("IMG"):new BOOMR.window.Image).src=n:i=t;o=i.naturalHeight||t.naturalHeight;a=i.naturalWidth||t.naturalWidth;!o&&!a||u[n][0]===o&&u[n][1]===a||u[n].push(o,a)}}});return u}function Y(e,t,r){var n,i=I(BOOMR.window,!0,0,0),o=x(BOOMR.window),a={};if(!i||!i.length)return{entries:[]};i.sort(function(e,t){return e.startTime-t.startTime});for(var s=[],c=0;c<i.length;c++)if((0===(n=i[c]).name.indexOf("http:")||0===n.name.indexOf("https:"))&&!(-1<n.name.indexOf(BOOMR.url)||-1<n.name.indexOf(BOOMR.config_url)||"function"==typeof BOOMR.getBeaconURL&&BOOMR.getBeaconURL()&&-1<n.name.indexOf(BOOMR.getBeaconURL())||e&&o+n.startTime<e)){if(t&&o+n.startTime>t)break;if(void 0===r||"*"===r||!r.length||n.initiatorType&&BOOMR.utils.inArray(n.initiatorType,r)){d(a,n.serverTiming);s.push(n)}}var u=p(a);return{entries:s,serverTiming:{lookup:u,indexed:g(u)}}}function j(e){var t,r,n;if(e.encodedBodySize||e.decodedBodySize||e.transferSize){t=e.transferSize;return[r=e.encodedBodySize,t?t-r:"_",(n=e.decodedBodySize)?n-r:0].map(U).join(",").replace(/,+$/,"")}return""}function F(e,t){var r,n,i;if(e&&t)for(r=0;r<t.length;r++)if("string"==typeof(i=t[r])){if(-1!==(n=e.indexOf(i))){e=e.substr(0,n+i.length)+"...";break}}else i instanceof RegExp&&i.test(e)&&(e=e.replace(i,"$1")+"...");return BOOMR.utils.cleanupURL(e,_.urlLimit)}function q(e){return e.responseEnd?e.responseEnd:e.responseStart&&e.startTime?e.responseStart+.2*(e.responseStart-e.startTime):1/0}function m(e,t,c){var r=BOOMR.window.screen,u=r.height,d=r.width;return t.reduce(function(e,t){var r,n,i=Math.max(0,t[3]),o=Math.max(0,t[2]),a=Math.min(t[3]+t[1],d),s=Math.min(t[2]+t[0],u);if(a<=i||s<=o)return e;for(n=o;n<s;n++){e[n]||(e[n]=[]);for(r=i;r<a;r++)e[n][r]=c}return e},e||[])}function l(e,r,n){r=r||0;n=n||1/0;return e.reduce(function(e,t){return e+t.filter(function(e){return r<=e&&e<=n}).length},0)}function n(e,t){var r,n,i,o,a,s={},c={},u=Y(e,t,_.trackedResourceTypes),d=u.entries,f=u.serverTiming;if(!d||!d.length)return{restiming:{},servertiming:[]};for(r=0;r<d.length;r++){n=d[r];void 0===(i=h[n.initiatorType])&&(i=0);a=i+[C(n.startTime,0),C(n.responseEnd,n.startTime),C(n.responseStart,n.startTime),C(n.requestStart,n.startTime),C(n.connectEnd,n.startTime),C(n.secureConnectionStart,n.startTime),C(n.connectStart,n.startTime),C(n.domainLookupEnd,n.startTime),C(n.domainLookupStart,n.startTime),C(n.redirectEnd,n.startTime),C(n.redirectStart,n.startTime)].map(U).join(",").replace(/,+$/,"");var p=j(n);""!==p&&(a+=S+O+p);n.hasOwnProperty("scriptAttrs")&&(a+=S+T+n.scriptAttrs);n.serverTiming&&n.serverTiming.length&&(a+=S+y+n.serverTiming.reduce(function(e,t,r){var n=String(void 0!==t.duration?t.duration:t.value);"0."===n.substring(0,2)&&(n=n.substring(1));var i=t.name||t.metric;return e+=(0<r?",":"")+n+$(f.indexed[i].index,f.indexed[i].descriptions[t.description])},""));n.hasOwnProperty("linkAttrs")&&(a+=S+B+n.linkAttrs);if(n.workerStart&&"number"==typeof n.workerStart&&0!==n.workerStart){var m=C(z(n.workerStart),n.startTime);a+=S+R+U(m)}o=F(n.name,_.trimUrls);if(n.hasOwnProperty("_data")){var l="";for(var g in n._data)n._data.hasOwnProperty(g)&&(l+=S+E+g+":"+n._data[g]);void 0===s[o]?s[o]=a+l:s[o]+=l}else void 0!==s[o]?s[o]+="|"+a:n.visibleDimensions?s[o]=S+v+n.visibleDimensions.map(Math.round).map(U).join(",").replace(/,+$/,"")+"|"+a:s[o]=a;if(n.visibleDimensions){c[n.latestTime]||(c[n.latestTime]=[]);c[n.latestTime].push(n.visibleDimensions)}}return{restiming:L(P(s,_.splitAtPath),!0),servertiming:f.lookup}}function c(e){var t=[];if(!e||!e.length)return t;for(var r=0;r<e.length;r++){var n=e[r];r!==e.length-1&&n.fetchStart===e[r+1].fetchStart||t.push({fetchStart:n.fetchStart,responseEnd:n.responseStart||n.responseEnd})}return t}function e(e,t){var r;if("undefined"!=typeof JSON){BOOMR.utils.mark("restiming:build:start");r=n(e,t);BOOMR.utils.mark("restiming:build:end");BOOMR.utils.measure("restiming:build","restiming:build:start","restiming:build:end");if(r){BOOMR.info("Client supports Resource Timing API","restiming");i(r)}}}function d(n,e){(e||[]).forEach(function(e){var t=e.name||e.metric;void 0===n[t]&&(n[t]={count:0,counts:{}});var r=n[t];r.counts[e.description]=r.counts[e.description]||0;r.counts[e.description]++;r.count++})}function p(n){return Object.keys(n).sort(function(e,t){return n[t].count-n[e].count}).reduce(function(e,r){var t=Object.keys(n[r].counts).sort(function(e,t){return n[r].counts[t]-n[r].counts[e]});e.push(1===t.length&&""===t[0]?r:[r].concat(t));return e},[])}function g(e){return e.reduce(function(e,t,r){var n,i;if(Array.isArray(t)){n=t[0];i=t.slice(1).reduce(function(e,t,r){e[t]=r;return e},{})}else{n=t;i={"":0}}e[n]={index:r,descriptions:i};return e},{})}function $(e,t){var r="";e&&(r+=e);t&&(r+="."+t);r.length&&(r=":"+r);return r}function i(e){BOOMR.addVar("restiming",JSON.stringify(e.restiming),!0);e.servertiming.length&&BOOMR.addVar("servertiming",BOOMR.utils.serializeForUrl(e.servertiming),!0)}}();
//# sourceMappingURL=restiming.min.js.map