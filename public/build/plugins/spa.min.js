!function(){var l,n=!1,e=!1,s=!1,p=!1,O=!1,g=!0,d=!1,f=!1,R=!1,a=[],r=!1;BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.SPA&&BOOMR.plugins.AutoXHR){var o={spaHardMissedOnComplete:function(t){var e,n=BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart();r=!1;BOOMR.addVar("spa.missed","1",!0);BOOMR.plugins.RT&&BOOMR.plugins.RT.clearTimer("t_done");t.timing.requestStart=n;0===t.resources.length&&(e=BOOMR.getPerformance())&&e.timing&&e.timing.navigationStart&&e.timing.loadEventEnd&&(t.timing.loadEventEnd=e.timing.loadEventEnd)},pageReady:function(){p=!0}};BOOMR.plugins.SPA={is_complete:function(){return!r},init:function(t){if(t&&t.instrument_xhr){O=t.instrument_xhr;s&&O&&BOOMR.plugins.AutoXHR.enableAutoXhr()}if(!e){e=!0;BOOMR.subscribe("page_ready",o.pageReady,null,o)}},register:function(t){a.push(t)},supported_frameworks:function(){return a},onLoadSpaHardMissed:function(){if(!s){p=!0;O&&BOOMR.plugins.AutoXHR.enableAutoXhr();r=!0;R?r=!1:BOOMR.plugins.SPA.route_change(o.spaHardMissedOnComplete)}},hook:function(t,e){e=e||{};c("Hooked");"function"==typeof e.routeFilter&&(d=e.routeFilter);"function"==typeof e.routeChangeWaitFilter&&(f=e.routeChangeWaitFilter);e.disableHardNav&&(R=e.disableHardNav);if(n)return this;t&&BOOMR.attach_page_ready(this.onLoadSpaHardMissed);n=!0;return this},route_change:function(e,t){c("Route Change");var n=!1,i=g&&!R?"spa_hard":"spa";if(l&&l.wait)c("Route change wait filter not complete; not tracking this route");else{if("spa"==i&&d)try{if(!d.apply(null,t)){c("Route filter returned false; not tracking this route");return}c("Route filter returned true; tracking this route")}catch(t){BOOMR.addError(t,"SPA.route_change.routeFilter")}s=!0;var a=BOOMR.plugins.RT&&BOOMR.plugins.RT.navigationStart(),r=p?BOOMR.now():a,o=BOOMR.window.document.URL;BOOMR.fireEvent("spa_init",[BOOMR.plugins.SPA.current_spa_nav(),o]);var u={timing:{requestStart:r},initiator:i,url:o};g=!1;if(!p||"function"==typeof e){p=!0;u.onComplete=function(t){if(!n){n=!0;BOOMR.fireEvent("spa_navigation")}"function"==typeof e&&e(t)}}if("spa"==i&&f){c("Running route change wait filter");try{if(f.apply(null,arguments)){c("Route filter returned true; waiting for complete call");u.wait=!0;l=u}else c("Route wait filter returned false; not waiting for complete call")}catch(t){BOOMR.addError(t,"SPA.route_change.routeChangeWaitFilter")}}u.index=BOOMR.plugins.AutoXHR.getMutationHandler().addEvent(u);O&&BOOMR.plugins.AutoXHR.enableAutoXhr()}},last_location:function(t){lastLocationChange=t},current_spa_nav:function(){return p?"spa":"spa_hard"},wait_complete:function(){c("Route change wait filter completed");if(l){l.wait=!1;if(l.waitComplete){c("Route wait filter complete");l.waitComplete()}l=null}},markNavigationComplete:function(){var t,e,n=BOOMR.plugins.AutoXHR.getMutationHandler();l&&l.wait&&BOOMR.plugins.SPA.wait_complete();if(n&&0<n.pending_events.length)for(t=n.pending_events.length-1;0<=t;t--)if((e=n.pending_events[t])&&BOOMR.utils.inArray(e.type,BOOMR.constants.BEACON_TYPE_SPAS)){if(e.complete)break;c("SPA Navigation being marked complete; nodes waiting for: "+n.nodesWaitingFor(t));BOOMR.addVar("spa.forced","1",!0);BOOMR.addVar("spa.waiting",n.nodesWaitingFor(),!0);n.completeEvent(t);return}c("No SPA navigation in progress to mark as complete")},isSpaNavInProgress:function(){var t,e,n=BOOMR.plugins.AutoXHR.getMutationHandler();if(n&&0<n.pending_events.length)for(t=n.pending_events.length-1;0<=t;t--)if((e=n.pending_events[t])&&BOOMR.utils.inArray(e.type,BOOMR.constants.BEACON_TYPE_SPAS))return!e.complete;return!1},isSinglePageApp:function(t){var e=!1,n=this.supported_frameworks();for(i=0;i<n.length;i++){var a=n[i];if(t[a]&&t[a].enabled){e=!0;break}}return e}};BOOMR.plugins.SPA.waitComplete=BOOMR.plugins.SPA.wait_complete}function c(t){BOOMR.debug(t,"SPA")}}();
//# sourceMappingURL=spa.min.js.map